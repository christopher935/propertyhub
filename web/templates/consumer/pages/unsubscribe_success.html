<!DOCTYPE html>
<html lang="en">
{{template "_head.html" .}}
<body class="scout-consumer-layout page-unsubscribe-success">
{{template "_svg_sprite.html"}}


    <div class="container">
        <div class="success-icon">âœ…</div>
        
        <h1>{{.Title}}</h1>
        
        <div class="email">{{.Email}}</div>
        
        <p class="message">{{.Message}}</p>
        
        {{if .ShowResubscribe}}
        <div class="resubscribe-section">
            <h3>Changed Your Mind?</h3>
            <p style="font-size: 14px; color: #666; margin-bottom: 15px;">
                You can resubscribe to our communications at any time.
            </p>
            
            <form class="resubscribe-form" id="resubscribeForm">
        <input type="hidden" name="csrf_token" value="{{.CSRFToken}}">
                <div class="form-group">
                    <label for="email">Email Address:</label>
                    <input type="email" id="email" name="email" value="{{.Email}}" required>
                </div>
                
                <div class="form-group">
                    <label for="type">Resubscribe to:</label>
                    <select id="type" name="type">
                        <option value="marketing">Marketing emails only</option>
                        <option value="alerts">Property alerts only</option>
                        <option value="all">All communications</option>
                    </select>
                </div>
                
                <button type="submit" class="btn">Resubscribe</button>
            </form>
            
            <div id="resubscribeAlert" class="alert"></div>
        </div>
        {{end}}
        
        <div class="footer">
            <div class="contact-info">
                <strong>Landlords of Texas, LLC</strong><br>
                Houston, TX 77002<br>
                Phone: <a href="tel:(281) 925-7222">(281) 925-7222</a><br>
                Email: <a href="mailto:info@landlordsoftexas.com">info@landlordsoftexas.com</a><br>
                Website: <a href="https://landlordsoftexas.com" target="_blank">landlordsoftexas.com</a>
            </div>
            
            <p style="margin-top: 15px; font-size: 12px;">
                Licensed Real Estate Broker | TREC License #9008008<br>
                Christopher Gross #625244
            </p>
        </div>
    </div>

    <script>
        document.getElementById('resubscribeForm')?.addEventListener('submit', function(e) {
            e.preventDefault();
            
            const formData = new FormData(this);
            const alertDiv = document.getElementById('resubscribeAlert');
            
            fetch('/api/unsubscribe/resubscribe', {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                if (data.error) {
                    alertDiv.className = 'alert alert-error';
                    alertDiv.textContent = 'Error: ' + data.error;
                } else {
                    alertDiv.className = 'alert alert-success';
                    alertDiv.textContent = 'Successfully resubscribed! You will start receiving communications again.';
                    
                    // Hide form after successful resubscribe
                    setTimeout(() => {
                        document.querySelector('.resubscribe-section').style.display = 'none';
                    }, 3000);
                }
                alertDiv.style.display = 'block';
            })
            .catch(error => {
                alertDiv.className = 'alert alert-error';
                alertDiv.textContent = 'Network error. Please try again or contact us directly.';
                alertDiv.style.display = 'block';
            });
        });
    </script>
    <script src="/static/js/cookie-consent.js"></script>
</body>
</html>