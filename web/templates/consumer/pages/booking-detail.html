<!DOCTYPE html>
<html lang="en">
{{template "_head.html" .}}
<body class="scout-consumer-layout page-booking-detail">
{{template "_svg_sprite.html"}}

    <div class="admin-layout">

<!-- CANONICAL ADMIN SIDEBAR - Extracted from https://llotschedule.online/admin/dashboard -->
<!-- This is the REAL production sidebar that ALL admin templates should use -->

<aside class="admin-sidebar">
    <div class="sidebar-header">
        <a href="/" class="sidebar-logo">
            <div class="sidebar-logo-icon">PH</div>
            <span>Landlords of Texas</span>
        </a>
    </div>

            <nav class="admin-sidebar-nav">
        
        <!-- Overview Section -->
        <div class="nav-section">
            <a href="/admin/dashboard" class="nav-section-header active" data-section="overview">
                <span class="nav-section-icon"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><use href="#icon-home"></use></svg></span>
                <span class="nav-section-title">Overview</span>
            </a>
        </div>

        <!-- Properties & Showings Section -->
        <div class="nav-section">
            <button class="nav-section-header" data-section="properties">
                <span class="nav-section-icon"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><use href="#icon-building-office"></use></svg></span>
                <span class="nav-section-title">Properties & Showings</span>
               
                <span class="nav-section-toggle"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><use href="#icon-chevron-right"></use></svg></span>
            </button>
            <ul class="nav-section-items">
                <li><a href="/admin/properties" class="nav-item">All Properties</a></li>
                <li><a href="/admin/performance" class="nav-item">Property Performance</a></li>
                <li><a href="/admin/photos" class="nav-item">Photos</a></li>
                <li><a href="/admin/calendar" class="nav-item">Showing Calendar</a></li>
                <li><a href="/admin/bookings" class="nav-item">Booking Management</a></li>
                <li><a href="/admin/har-sync" class="nav-item">HAR Sync</a></li>
                <li><a href="/admin/pre-listing-manager" class="nav-item">Pre-Listing Manager</a></li>
                <li><a href="/admin/valuations" class="nav-item">Valuations</a></li>
            </ul>
        </div>

        <!-- Leads & Conversion Section -->
        <div class="nav-section">
            <button class="nav-section-header" data-section="leads">
                <span class="nav-section-icon"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><use href="#icon-users"></use></svg></span>
                <span class="nav-section-title">Leads & Conversion</span>
               
                <span class="nav-section-toggle"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><use href="#icon-chevron-right"></use></svg></span>
            </button>
            <ul class="nav-section-items">
                <li><a href="/admin/lead-management" class="nav-item">Lead Management</a></li>
                <li><a href="/admin/lead-sources" class="nav-item">Lead Sources</a></li>
                <li><a href="/admin/conversion-funnel" class="nav-item">Conversion Funnel</a></li>
                <li><a href="/admin/client-portal" class="nav-item">Client Portal</a></li>
                <li><a href="/admin/behavioral-intelligence" class="nav-item">Behavioral Intelligence</a></li>
            </ul>
        </div>

        <!-- Communications Section -->
        <div class="nav-section">
            <button class="nav-section-header" data-section="communications">
                <span class="nav-section-icon"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><use href="#icon-chat-bubble-left"></use></svg></span>
                <span class="nav-section-title">Communications</span>
                <span class="nav-section-toggle"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><use href="#icon-chevron-right"></use></svg></span>
            </button>
            <ul class="nav-section-items">
                <li><a href="/admin/communication-center" class="nav-item">Communication Center</a></li>
                <li><a href="/admin/email-management" class="nav-item">Email Management</a></li>
            </ul>
        </div>

        <!-- Workflow Section -->
        <div class="nav-section">
            <button class="nav-section-header" data-section="workflow">
                <span class="nav-section-icon"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><use href="#icon-arrows-right-left"></use></svg></span>
                <span class="nav-section-title">Workflow</span>
                <span class="nav-section-toggle"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><use href="#icon-chevron-right"></use></svg></span>
            </button>
            <ul class="nav-section-items">
                <li><a href="/admin/applications" class="nav-item">Applications</a></li>
                <li><a href="/admin/approvals" class="nav-item">Approvals</a></li>
                <li><a href="/admin/closing-pipeline" class="nav-item">Closing Pipeline</a></li>
            </ul>
        </div>

        <!-- Analytics & Reports Section -->
        <div class="nav-section">
            <button class="nav-section-header" data-section="analytics">
                <span class="nav-section-icon"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><use href="#icon-chart-bar"></use></svg></span>
                <span class="nav-section-title">Analytics & Reports</span>
                <span class="nav-section-toggle"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><use href="#icon-chevron-right"></use></svg></span>
            </button>
            <ul class="nav-section-items">
                <li><a href="/admin/business-intelligence" class="nav-item">Business Intelligence</a></li>
                <li><a href="/admin/market-analytics" class="nav-item">Market Analytics</a></li>
                <li><a href="/admin/performance-reports" class="nav-item">Performance Reports</a></li>
                <li><a href="/admin/custom-reports" class="nav-item">Custom Reports</a></li>
                <li><a href="/admin/friday-reports" class="nav-item">Friday Reports</a></li>
            </ul>
        </div>

        <!-- System Section -->
        <div class="nav-section">
            <button class="nav-section-header" data-section="system">
                <span class="nav-section-icon"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><use href="#icon-cog"></use></svg></span>
                <span class="nav-section-title">System</span>
                <span class="nav-section-toggle"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><use href="#icon-chevron-right"></use></svg></span>
            </button>
            <ul class="nav-section-items">
                <li><a href="/admin/settings" class="nav-item">Settings</a></li>
                <li><a href="/admin/security" class="nav-item">Security</a></li>
                <li><a href="/admin/users" class="nav-item">User Management</a></li>
                <li><a href="/admin/rbac" class="nav-item">Access Control (RBAC)</a></li>
                <li><a href="/admin/audit-logs" class="nav-item">Audit Logs</a></li>
                <li><a href="/admin/integrations" class="nav-item">Integrations</a></li>
                <li><a href="/admin/data-migration" class="nav-item">Data Migration</a></li>
            </ul>
        </div>
    </nav>


</aside>


        <main class="admin-main">

<!-- CANONICAL ADMIN TOP BAR - COMPLETE WITH USER DROPDOWN -->
<!-- From Production Dashboard - https://llotschedule.online/admin/dashboard -->
<!-- WHEN COPYING: Change "Analytics Dashboard" below to your page title -->

<div class="admin-top-bar">
    <div class="admin-page-header">
        <h1 class="admin-page-title">Showing Details</h1>
    </div>
    
    <div class="admin-top-bar-right">
        <!-- Search -->
        <div class="admin-search">
            <input type="text" class="form-input" placeholder="Search leads, properties..." id="globalSearch">
            <span class="admin-search-icon"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><use href="#icon-search"></use></svg></span>
        </div>

        <!-- Notifications -->
        <div class="admin-notifications">
            <button class="admin-notification-button" id="notificationButton" title="Notifications">
                <span class="notification-icon"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><use href="#icon-bell"></use></svg></span>
                <span class="notification-badge" id="notificationBadge">3</span>
            </button>
        </div>

        <!-- User Menu with Dropdown -->
        <div class="admin-user-dropdown">
            <button class="admin-user-button" id="userMenuButton">
                <div class="admin-user-avatar">CG</div>
                <div class="admin-user-info">
                    <div class="admin-user-name">Christopher Gross</div>
                    <div class="admin-user-role">Administrator</div>
                </div>
                <span class="admin-user-chevron">▼</span>
            </button>
            <div class="admin-user-menu" id="userMenu">
                <a href="/admin/profile" class="admin-user-menu-item">
                    <span class="menu-icon"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><use href="#icon-user"></use></svg></span>
                    <span>Profile</span>
                </a>
                <a href="/admin/settings" class="admin-user-menu-item">
                    <span class="menu-icon"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><use href="#icon-settings"></use></svg></span>
                    <span>Settings</span>
                </a>
                <a href="/help" class="admin-user-menu-item">
                    <span class="menu-icon"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><use href="#icon-question"></use></svg></span>
                    <span>Help & Support</span>
                </a>
                <div class="admin-user-menu-divider"></div>
                <a href="/admin/logout" class="admin-user-menu-item admin-user-menu-logout" onclick="handleLogout(event)">
                    <span class="menu-icon"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><use href="#icon-door"></use></svg></span>
                    <span>Logout</span>
                </a>
            </div>
        </div>
    </div>
</div>


            <div class="admin-content">

                <section class="analytics-module">
                    <div class="module-header">
                        <h2 class="text-heading-3">Showing Details</h2>
                        <div style="display: flex; gap: 0.5rem;">
                            <button class="btn btn-success" onclick="markCompleted()">✓ Client Showed Up</button>
                            <button class="btn btn-warning" onclick="markNoShow()">✗ No-Show</button>
                            <button class="btn btn-secondary" onclick="rescheduleShowing()">Reschedule</button>
                            <button class="btn btn-danger" onclick="cancelShowing()">Cancel</button>
                        </div>
                    </div>

                    <div style="display: grid; grid-template-columns: 2fr 1fr; gap: 1.5rem;">
                        <div>
                            <section class="analytics-module">
                                <h3 class="text-heading-4">Showing Information</h3>
                                <table class="data-table">
                                    <tr><td><strong>Date & Time</strong></td><td>Nov 1, 2025 at 2:00 PM</td></tr>
                                    <tr><td><strong>Duration</strong></td><td>30 minutes</td></tr>
                                    <tr><td><strong>Status</strong></td><td><span class="badge badge-info">Scheduled</span></td></tr>
                                    <tr><td><strong>Confirmation</strong></td><td>✓ Confirmed via email</td></tr>
                                </table>
                            </section>

                            <section class="analytics-module">
                                <h3 class="text-heading-4">Property</h3>
                                <p><strong>1234 River Oaks Blvd</strong><br>
                                Houston, TX 77019<br>
                                4 bed / 3 bath • $4,500/mo<br>
                                <a href="/admin/property-detail/1">View Property Details →</a></p>
                            </section>

                            <section class="analytics-module">
                                <h3 class="text-heading-4">Notes</h3>
                                <textarea class="form-input" rows="4" placeholder="Add notes about this showing..."></textarea>
                                <button class="btn btn-secondary" style="margin-top: 0.5rem;">Save Notes</button>
                            </section>
                        </div>

                        <div>
                            <section class="analytics-module">
                                <h3 class="text-heading-4">Client</h3>
                                <p><strong>John Doe</strong><br>
                                john.doe@email.com<br>
                                (713) 555-0100<br><br>
                                <strong>Budget:</strong> $4,000-$5,000/mo<br>
                                <strong>Move-in:</strong> Dec 1, 2025</p>
                            </section>

                            <section class="analytics-module">
                                <h3 class="text-heading-4">Agent</h3>
                                <p><strong>Mike Thompson</strong><br>
                                Senior Agent<br>
                                mike@landlordsoftexas.com<br>
                                (281) 925-7222</p>
                            </section>

                            <section class="analytics-module">
                                <h3 class="text-heading-4">Reminders</h3>
                                <p>✓ Email sent (24h before)<br>
                                ✓ SMS sent (2h before)<br>
                                ⏳ Follow-up scheduled (24h after)</p>
                            </section>
                        </div>
                    </div>
                </section>
                            </div>
                            <div class="alert-card-body">
                                <p class="text-body">96/100</p>
                                <p class="text-body-sm text-gray-600">Excellent data hygiene</p>
                            </div>
                        </div>

                        <div class="alert-card alert-info">
                            <div class="alert-card-header">
                                <span class="alert-card-icon"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><use href="#icon-info"></use></svg></span>
                                <span class="alert-card-title">FUB Sync Status</span>
                            </div>
                            <div class="alert-card-body">
                                <p class="text-body">Last synced 5 min ago</p>
                                <p class="text-body-sm text-gray-600">247 leads • 0 errors</p>
                            </div>
                        </div>

                        <div class="alert-card alert-warning">
                            <div class="alert-card-header">
                                <span class="alert-card-icon"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><use href="#icon-warning"></use></svg></span>
                                <span class="alert-card-title">Missing Data</span>
                            </div>
                            <div class="alert-card-body">
                                <p class="text-body">12 leads missing phone</p>
                                <p class="text-body-sm text-gray-600"><a href="/admin/data-cleanup">Review & fix</a></p>
                            </div>
                        </div>
                    </div>
                </section>

            </div>

            <!-- Footer -->
            {{template "_footer.html"}}
        </main>
    </div>

    <script>
        // Initialize navigation
        function initializeNavigation() {
            const navSections = document.querySelectorAll('.nav-section-header');
            navSections.forEach(header => {
                header.addEventListener('click', function() {
                    const section = this.closest('.nav-section');
                    const items = section.querySelector('.nav-section-items');
                    const toggle = this.querySelector('.nav-section-toggle');
                    
                    if (items.style.display === 'block') {
                        items.style.display = 'none';
                        toggle.textContent = '▶';
                        this.classList.remove('active');
                    } else {
                        items.style.display = 'block';
                        toggle.textContent = '▼';
                        this.classList.add('active');
                    }
                });
            });
        }

        // Initialize dropdowns
        function initializeDropdowns() {
            const notificationsBtn = document.getElementById('notifications-btn');
            const notificationsDropdown = document.getElementById('notifications-dropdown');
            const userMenuBtn = document.getElementById('user-menu-btn');
            const userDropdown = document.getElementById('user-dropdown');

            notificationsBtn?.addEventListener('click', (e) => {
                e.stopPropagation();
                notificationsDropdown.style.display = notificationsDropdown.style.display === 'none' ? 'block' : 'none';
                userDropdown.style.display = 'none';
            });

            userMenuBtn?.addEventListener('click', (e) => {
                e.stopPropagation();
                userDropdown.style.display = userDropdown.style.display === 'none' ? 'block' : 'none';
                notificationsDropdown.style.display = 'none';
            });

            document.addEventListener('click', () => {
                notificationsDropdown.style.display = 'none';
                userDropdown.style.display = 'none';
            });
        }

        // Initialize charts
        function initializeCharts() {
            const ctx = document.getElementById('conversion-funnel-chart');
            if (ctx) {
                new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: ['Leads', 'Contacted', 'Showings', 'Applications', 'Leases'],
                        datasets: [{
                            label: 'Count',
                            data: [364, 287, 126, 82, 64],
                            backgroundColor: 'rgba(0, 51, 102, 0.8)'
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: { display: false }
                        }
                    }
                });
            }
        }

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function() {
            initializeNavigation();
            initializeDropdowns();
            initializeCharts();
        });

        // Refresh analytics
        document.getElementById('refresh-analytics')?.addEventListener('click', function() {
            const icon = this.querySelector('.btn-icon');
            icon.style.animation = 'spin 1s linear';
            setTimeout(() => {
                icon.style.animation = '';
                location.reload();
            }, 1000);
        });

        // Booking action handlers
        function markCompleted() {
            if (confirm('Mark this showing as completed?\n\nThis will:\n✓ Update status to "Completed"\n✓ Send application link to client\n✓ Track conversion metrics')) {
                alert('Showing marked as completed!\n\nApplication link sent to john.doe@email.com\n\nAPI: POST /api/bookings/1/complete');
                // TODO: Actual API call
                // window.location.reload();
            }
        }

        function markNoShow() {
            if (confirm('Mark this showing as no-show?\n\nThis will:\n✓ Update status to "No-Show"\n✓ Send follow-up email\n✓ AI will suggest reschedule or alternative properties')) {
                alert('Showing marked as no-show!\n\nFollow-up email sent with reschedule options\n\nAPI: POST /api/bookings/1/no-show');
                // TODO: Actual API call
                // window.location.reload();
            }
        }

        function rescheduleShowing() {
            alert('Reschedule functionality\n\nWill open calendar picker to select new date/time\n\nAPI: PUT /api/bookings/1/reschedule');
            // TODO: Calendar integration
        }

        function cancelShowing() {
            if (confirm('Cancel this showing?\n\nThis will:\n✗ Cancel the showing\n✓ Send cancellation email to client\n✓ Free up agent\'s calendar slot')) {
                alert('Showing cancelled!\n\nCancellation email sent\n\nAPI: DELETE /api/bookings/1');
                // TODO: Actual API call
                // window.location.href = '/admin/bookings-list';
            }
        }
    </script>
</body>
</html>
