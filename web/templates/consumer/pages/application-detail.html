<!DOCTYPE html>
<html lang="en">
{{template "_head.html" .}}
<body class="scout-consumer-layout page-application-detail">
{{template "_svg_sprite.html"}}

    <div class="admin-layout">

<!-- CANONICAL ADMIN SIDEBAR - Extracted from https://llotschedule.online/admin/dashboard -->
<!-- This is the REAL production sidebar that ALL admin templates should use -->

<aside class="admin-sidebar">
    <div class="sidebar-header">
        <a href="/" class="sidebar-logo">
            <div class="sidebar-logo-icon">PH</div>
            <span>Landlords of Texas</span>
        </a>
    </div>

            <nav class="admin-sidebar-nav">
        
        <!-- Overview Section -->
        <div class="nav-section">
            <a href="/admin/dashboard" class="nav-section-header active" data-section="overview">
                <span class="nav-section-icon"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><use href="#icon-home"></use></svg></span>
                <span class="nav-section-title">Overview</span>
            </a>
        </div>

        <!-- Properties & Showings Section -->
        <div class="nav-section">
            <button class="nav-section-header" data-section="properties">
                <span class="nav-section-icon"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><use href="#icon-building-office"></use></svg></span>
                <span class="nav-section-title">Properties & Showings</span>
               
                <span class="nav-section-toggle"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><use href="#icon-chevron-right"></use></svg></span>
            </button>
            <ul class="nav-section-items">
                <li><a href="/admin/properties" class="nav-item">All Properties</a></li>
                <li><a href="/admin/performance" class="nav-item">Property Performance</a></li>
                <li><a href="/admin/photos" class="nav-item">Photos</a></li>
                <li><a href="/admin/calendar" class="nav-item">Showing Calendar</a></li>
                <li><a href="/admin/bookings" class="nav-item">Booking Management</a></li>
                <li><a href="/admin/har-sync" class="nav-item">HAR Sync</a></li>
                <li><a href="/admin/pre-listing-manager" class="nav-item">Pre-Listing Manager</a></li>
                <li><a href="/admin/valuations" class="nav-item">Valuations</a></li>
            </ul>
        </div>

        <!-- Leads & Conversion Section -->
        <div class="nav-section">
            <button class="nav-section-header" data-section="leads">
                <span class="nav-section-icon"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><use href="#icon-users"></use></svg></span>
                <span class="nav-section-title">Leads & Conversion</span>
               
                <span class="nav-section-toggle"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><use href="#icon-chevron-right"></use></svg></span>
            </button>
            <ul class="nav-section-items">
                <li><a href="/admin/lead-management" class="nav-item">Lead Management</a></li>
                <li><a href="/admin/lead-sources" class="nav-item">Lead Sources</a></li>
                <li><a href="/admin/conversion-funnel" class="nav-item">Conversion Funnel</a></li>
                <li><a href="/admin/client-portal" class="nav-item">Client Portal</a></li>
                <li><a href="/admin/behavioral-intelligence" class="nav-item">Behavioral Intelligence</a></li>
            </ul>
        </div>

        <!-- Communications Section -->
        <div class="nav-section">
            <button class="nav-section-header" data-section="communications">
                <span class="nav-section-icon"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><use href="#icon-chat-bubble-left"></use></svg></span>
                <span class="nav-section-title">Communications</span>
                <span class="nav-section-toggle"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><use href="#icon-chevron-right"></use></svg></span>
            </button>
            <ul class="nav-section-items">
                <li><a href="/admin/communication-center" class="nav-item">Communication Center</a></li>
                <li><a href="/admin/email-management" class="nav-item">Email Management</a></li>
            </ul>
        </div>

        <!-- Workflow Section -->
        <div class="nav-section">
            <button class="nav-section-header" data-section="workflow">
                <span class="nav-section-icon"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><use href="#icon-arrows-right-left"></use></svg></span>
                <span class="nav-section-title">Workflow</span>
                <span class="nav-section-toggle"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><use href="#icon-chevron-right"></use></svg></span>
            </button>
            <ul class="nav-section-items">
                <li><a href="/admin/applications" class="nav-item">Applications</a></li>
                <li><a href="/admin/approvals" class="nav-item">Approvals</a></li>
                <li><a href="/admin/closing-pipeline" class="nav-item">Closing Pipeline</a></li>
            </ul>
        </div>

        <!-- Analytics & Reports Section -->
        <div class="nav-section">
            <button class="nav-section-header" data-section="analytics">
                <span class="nav-section-icon"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><use href="#icon-chart-bar"></use></svg></span>
                <span class="nav-section-title">Analytics & Reports</span>
                <span class="nav-section-toggle"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><use href="#icon-chevron-right"></use></svg></span>
            </button>
            <ul class="nav-section-items">
                <li><a href="/admin/business-intelligence" class="nav-item">Business Intelligence</a></li>
                <li><a href="/admin/market-analytics" class="nav-item">Market Analytics</a></li>
                <li><a href="/admin/performance-reports" class="nav-item">Performance Reports</a></li>
                <li><a href="/admin/custom-reports" class="nav-item">Custom Reports</a></li>
                <li><a href="/admin/friday-reports" class="nav-item">Friday Reports</a></li>
            </ul>
        </div>

        <!-- System Section -->
        <div class="nav-section">
            <button class="nav-section-header" data-section="system">
                <span class="nav-section-icon"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><use href="#icon-cog"></use></svg></span>
                <span class="nav-section-title">System</span>
                <span class="nav-section-toggle"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><use href="#icon-chevron-right"></use></svg></span>
            </button>
            <ul class="nav-section-items">
                <li><a href="/admin/settings" class="nav-item">Settings</a></li>
                <li><a href="/admin/security" class="nav-item">Security</a></li>
                <li><a href="/admin/users" class="nav-item">User Management</a></li>
                <li><a href="/admin/rbac" class="nav-item">Access Control (RBAC)</a></li>
                <li><a href="/admin/audit-logs" class="nav-item">Audit Logs</a></li>
                <li><a href="/admin/integrations" class="nav-item">Integrations</a></li>
                <li><a href="/admin/data-migration" class="nav-item">Data Migration</a></li>
            </ul>
        </div>
    </nav>


</aside>


        <main class="admin-main">

<!-- CANONICAL ADMIN TOP BAR - COMPLETE WITH USER DROPDOWN -->
<!-- From Production Dashboard - https://llotschedule.online/admin/dashboard -->
<!-- WHEN COPYING: Change "Analytics Dashboard" below to your page title -->

<div class="admin-top-bar">
    <div class="admin-page-header">
        <h1 class="admin-page-title">Application Review</h1>
    </div>
    
    <div class="admin-top-bar-right">
        <!-- Search -->
        <div class="admin-search">
            <input type="text" class="form-input" placeholder="Search leads, properties..." id="globalSearch">
            <span class="admin-search-icon"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><use href="#icon-search"></use></svg></span>
        </div>

        <!-- Notifications -->
        <div class="admin-notifications">
            <button class="admin-notification-button" id="notificationButton" title="Notifications">
                <span class="notification-icon"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><use href="#icon-bell"></use></svg></span>
                <span class="notification-badge" id="notificationBadge">3</span>
            </button>
        </div>

        <!-- User Menu with Dropdown -->
        <div class="admin-user-dropdown">
            <button class="admin-user-button" id="userMenuButton">
                <div class="admin-user-avatar">CG</div>
                <div class="admin-user-info">
                    <div class="admin-user-name">Christopher Gross</div>
                    <div class="admin-user-role">Administrator</div>
                </div>
                <span class="admin-user-chevron">▼</span>
            </button>
            <div class="admin-user-menu" id="userMenu">
                <a href="/admin/profile" class="admin-user-menu-item">
                    <span class="menu-icon"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><use href="#icon-user"></use></svg></span>
                    <span>Profile</span>
                </a>
                <a href="/admin/settings" class="admin-user-menu-item">
                    <span class="menu-icon"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><use href="#icon-settings"></use></svg></span>
                    <span>Settings</span>
                </a>
                <a href="/help" class="admin-user-menu-item">
                    <span class="menu-icon"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><use href="#icon-question"></use></svg></span>
                    <span>Help & Support</span>
                </a>
                <div class="admin-user-menu-divider"></div>
                <a href="/admin/logout" class="admin-user-menu-item admin-user-menu-logout" onclick="handleLogout(event)">
                    <span class="menu-icon"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><use href="#icon-door"></use></svg></span>
                    <span>Logout</span>
                </a>
            </div>
        </div>
    </div>
</div>


            <div class="admin-content">

                <section class="analytics-module">
                    <div class="module-header">
                        <h2 class="text-heading-3">Application Review</h2>
                        <div style="display: flex; gap: 0.5rem;">
                            <button class="btn btn-success" onclick="approveApplication()">✓ Approve</button>
                            <button class="btn btn-warning" onclick="requestMoreInfo()">Request More Info</button>
                            <button class="btn btn-danger" onclick="denyApplication()">✗ Deny</button>
                        </div>
                    </div>

                    <div style="display: grid; grid-template-columns: 2fr 1fr; gap: 1.5rem;">
                        <div>
                            <section class="analytics-module">
                                <h3 class="text-heading-4">Applicant Information</h3>
                                <table class="data-table">
                                    <tr><td><strong>Name</strong></td><td>John Doe</td></tr>
                                    <tr><td><strong>Email</strong></td><td>john.doe@email.com</td></tr>
                                    <tr><td><strong>Phone</strong></td><td>(713) 555-0100</td></tr>
                                    <tr><td><strong>Date of Birth</strong></td><td>Jan 15, 1990</td></tr>
                                    <tr><td><strong>SSN</strong></td><td>***-**-1234</td></tr>
                                    <tr><td><strong>Current Address</strong></td><td>123 Main St, Houston, TX 77001</td></tr>
                                </table>
                            </section>

                            <section class="analytics-module">
                                <h3 class="text-heading-4">Employment & Income</h3>
                                <table class="data-table">
                                    <tr><td><strong>Employer</strong></td><td>Tech Corp Inc.</td></tr>
                                    <tr><td><strong>Position</strong></td><td>Software Engineer</td></tr>
                                    <tr><td><strong>Annual Income</strong></td><td>$135,000</td></tr>
                                    <tr><td><strong>Employment Length</strong></td><td>3 years</td></tr>
                                    <tr><td><strong>Income Verification</strong></td><td><span class="badge badge-success">✓ Verified</span></td></tr>
                                </table>
                            </section>

                            <section class="analytics-module">
                                <h3 class="text-heading-4">Credit & Background</h3>
                                <table class="data-table">
                                    <tr><td><strong>Credit Score</strong></td><td><span class="badge badge-success">750</span> (Excellent)</td></tr>
                                    <tr><td><strong>Background Check</strong></td><td><span class="badge badge-success">✓ Clear</span></td></tr>
                                    <tr><td><strong>Eviction History</strong></td><td><span class="badge badge-success">None</span></td></tr>
                                    <tr><td><strong>Criminal Record</strong></td><td><span class="badge badge-success">None</span></td></tr>
                                </table>
                            </section>

                            <section class="analytics-module">
                                <h3 class="text-heading-4">References</h3>
                                <table class="data-table">
                                    <thead><tr><th>Name</th><th>Relationship</th><th>Phone</th><th>Status</th></tr></thead>
                                    <tbody>
                                        <tr><td>Sarah Johnson</td><td>Previous Landlord</td><td>(713) 555-0300</td><td><span class="badge badge-success">✓ Verified</span></td></tr>
                                        <tr><td>Mike Williams</td><td>Employer</td><td>(713) 555-0301</td><td><span class="badge badge-success">✓ Verified</span></td></tr>
                                    </tbody>
                                </table>
                            </section>
                        </div>

                        <div>
                            <section class="analytics-module">
                                <h3 class="text-heading-4">Property</h3>
                                <p><strong>1234 River Oaks Blvd</strong><br>
                                Houston, TX 77019<br>
                                4 bed / 3 bath<br>
                                <strong>$4,500/mo</strong><br><br>
                                <a href="/admin/property-detail/1">View Property →</a></p>
                            </section>

                            <section class="analytics-module">
                                <h3 class="text-heading-4">Application Status</h3>
                                <p><span class="badge badge-warning">Pending Review</span><br><br>
                                <strong>Submitted:</strong> Nov 1, 2025<br>
                                <strong>Application Fee:</strong> $50 (Paid)<br>
                                <strong>Desired Move-in:</strong> Dec 1, 2025</p>
                            </section>

                            <section class="analytics-module">
                                <h3 class="text-heading-4">Income Ratio</h3>
                                <p><strong>Monthly Income:</strong> $11,250<br>
                                <strong>Monthly Rent:</strong> $4,500<br>
                                <strong>Ratio:</strong> 40.0%<br>
                                <span class="badge badge-success">✓ Meets 3x requirement</span></p>
                            </section>

                            <section class="analytics-module">
                                <h3 class="text-heading-4">Documents</h3>
                                <p>✓ Photo ID<br>
                                ✓ Pay Stubs (3 months)<br>
                                ✓ Bank Statements<br>
                                ✓ Employment Letter</p>
                            </section>
                        </div>
                    </div>
                </section>
                            </div>
                            <div class="alert-card-body">
                                <p class="text-body">96/100</p>
                                <p class="text-body-sm text-gray-600">Excellent data hygiene</p>
                            </div>
                        </div>

                        <div class="alert-card alert-info">
                            <div class="alert-card-header">
                                <span class="alert-card-icon"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><use href="#icon-info"></use></svg></span>
                                <span class="alert-card-title">FUB Sync Status</span>
                            </div>
                            <div class="alert-card-body">
                                <p class="text-body">Last synced 5 min ago</p>
                                <p class="text-body-sm text-gray-600">247 leads • 0 errors</p>
                            </div>
                        </div>

                        <div class="alert-card alert-warning">
                            <div class="alert-card-header">
                                <span class="alert-card-icon"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><use href="#icon-warning"></use></svg></span>
                                <span class="alert-card-title">Missing Data</span>
                            </div>
                            <div class="alert-card-body">
                                <p class="text-body">12 leads missing phone</p>
                                <p class="text-body-sm text-gray-600"><a href="/admin/data-cleanup">Review & fix</a></p>
                            </div>
                        </div>
                    </div>
                </section>

            </div>

            <!-- Footer -->
            {{template "_footer.html"}}
        </main>
    </div>

    <script>
        // Initialize navigation
        function initializeNavigation() {
            const navSections = document.querySelectorAll('.nav-section-header');
            navSections.forEach(header => {
                header.addEventListener('click', function() {
                    const section = this.closest('.nav-section');
                    const items = section.querySelector('.nav-section-items');
                    const toggle = this.querySelector('.nav-section-toggle');
                    
                    if (items.style.display === 'block') {
                        items.style.display = 'none';
                        toggle.textContent = '▶';
                        this.classList.remove('active');
                    } else {
                        items.style.display = 'block';
                        toggle.textContent = '▼';
                        this.classList.add('active');
                    }
                });
            });
        }

        // Initialize dropdowns
        function initializeDropdowns() {
            const notificationsBtn = document.getElementById('notifications-btn');
            const notificationsDropdown = document.getElementById('notifications-dropdown');
            const userMenuBtn = document.getElementById('user-menu-btn');
            const userDropdown = document.getElementById('user-dropdown');

            notificationsBtn?.addEventListener('click', (e) => {
                e.stopPropagation();
                notificationsDropdown.style.display = notificationsDropdown.style.display === 'none' ? 'block' : 'none';
                userDropdown.style.display = 'none';
            });

            userMenuBtn?.addEventListener('click', (e) => {
                e.stopPropagation();
                userDropdown.style.display = userDropdown.style.display === 'none' ? 'block' : 'none';
                notificationsDropdown.style.display = 'none';
            });

            document.addEventListener('click', () => {
                notificationsDropdown.style.display = 'none';
                userDropdown.style.display = 'none';
            });
        }

        // Initialize charts
        function initializeCharts() {
            const ctx = document.getElementById('conversion-funnel-chart');
            if (ctx) {
                new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: ['Leads', 'Contacted', 'Showings', 'Applications', 'Leases'],
                        datasets: [{
                            label: 'Count',
                            data: [364, 287, 126, 82, 64],
                            backgroundColor: 'rgba(0, 51, 102, 0.8)'
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: { display: false }
                        }
                    }
                });
            }
        }

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function() {
            initializeNavigation();
            initializeDropdowns();
            initializeCharts();
        });

        // Refresh analytics
        document.getElementById('refresh-analytics')?.addEventListener('click', function() {
            const icon = this.querySelector('.btn-icon');
            icon.style.animation = 'spin 1s linear';
            setTimeout(() => {
                icon.style.animation = '';
                location.reload();
            }, 1000);
        });

        // Application action handlers
        function approveApplication() {
            if (confirm('Approve this application?\n\nThis will:\n✓ Set status to "Approved"\n✓ Trigger Zipforms to send lease documents\n✓ Send approval email to applicant\n✓ Notify property owner')) {
                alert('Application approved!\n\nZipforms triggered for lease documents\nApproval email sent to john.doe@email.com\n\nAPI: POST /api/applications/1/approve');
                // TODO: Actual API call
                // window.location.href = '/admin/applications-list';
            }
        }

        function requestMoreInfo() {
            const info = prompt('What additional information do you need?\n\nExamples:\n- Additional income verification\n- Previous landlord reference\n- Co-signer information\n- Pet documentation');
            if (info) {
                alert('Request sent!\n\nEmail sent to applicant requesting:\n' + info + '\n\nStatus updated to "Pending More Info"\n\nAPI: POST /api/applications/1/request-info');
                // TODO: Actual API call
            }
        }

        function denyApplication() {
            if (confirm('Deny this application?\n\nThis will:\n✗ Set status to "Denied"\n✓ Send denial email (with fair housing compliance)\n✓ Archive application\n\nThis action cannot be undone.')) {
                const reason = prompt('Reason for denial (required for compliance):\n\nExamples:\n- Insufficient income (does not meet 3x rent requirement)\n- Negative rental history\n- Failed background check');
                if (reason) {
                    alert('Application denied\n\nReason: ' + reason + '\n\nCompliance email sent\n\nAPI: POST /api/applications/1/deny');
                    // TODO: Actual API call
                    // window.location.href = '/admin/applications-list';
                }
            }
        }
    </script>
</body>
</html>
