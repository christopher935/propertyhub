{{template "admin-base" .}}

{{define "head"}}
<script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1/dist/chart.min.js"></script>
{{end}}

{{define "content"}}
<div class="tab-nav">
    <button class="tab-button active" data-tab="tab1">Team Overview</button>
    <button class="tab-button" data-tab="tab2">Agent Performance</button>
    <button class="tab-button" data-tab="tab3">Assignments</button>
    <button class="tab-button" data-tab="tab4">Commissions</button>
</div>

<div class="tab-content active" id="tab1">
    <div class="stats-grid-4">
        <div class="stat-card">
            <div class="stat-card-label">Total Team Members</div>
            <div class="stat-card-value">12</div>
            <div class="stat-card-change positive">+2 this month</div>
        </div>
        <div class="stat-card">
            <div class="stat-card-label">Active Agents</div>
            <div class="stat-card-value">10</div>
            <div class="stat-card-change">83% utilization</div>
        </div>
        <div class="stat-card">
            <div class="stat-card-label">Total Deals This Month</div>
            <div class="stat-card-value">47</div>
            <div class="stat-card-change positive">+12% vs last month</div>
        </div>
        <div class="stat-card">
            <div class="stat-card-label">Team Revenue</div>
            <div class="stat-card-value">$284K</div>
            <div class="stat-card-change positive">+18% vs last month</div>
        </div>
    </div>

    <div class="section-header">
        <div class="section-label admin-section-label">
          <span class="section-label-line"></span>
          <span class="section-label-text">Team Members</span>
          <span class="section-label-line"></span>
        </div>
        <a href="/admin/team/add" class="btn btn-primary">Add Team Member</a>
    </div>

    <table class="performance-table">
        <thead>
            <tr>
                <th>Agent</th>
                <th>Role</th>
                <th>Status</th>
                <th>Active Deals</th>
                <th>Total Deals</th>
                <th>Revenue</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td class="property-address-cell">
                    <div class="agent-info">
                        <div class="agent-avatar">MJ</div>
                        <div>
                            <div class="agent-name">Mike Johnson</div>
                            <div class="agent-email">mike@propertyhub.com</div>
                        </div>
                    </div>
                </td>
                <td><span class="badge badge-info">Senior Agent</span></td>
                <td><span class="badge badge-success">Active</span></td>
                <td class="metric-value">8</td>
                <td class="metric-value">142</td>
                <td class="metric-value">$52,300</td>
                <td>
                    <button class="btn btn-sm btn-secondary">View</button>
                    <button class="btn btn-sm btn-secondary">Edit</button>
                </td>
            </tr>
            <tr>
                <td class="property-address-cell">
                    <div class="agent-info">
                        <div class="agent-avatar">AS</div>
                        <div>
                            <div class="agent-name">Amy Smith</div>
                            <div class="agent-email">amy@propertyhub.com</div>
                        </div>
                    </div>
                </td>
                <td><span class="badge badge-info">Agent</span></td>
                <td><span class="badge badge-success">Active</span></td>
                <td class="metric-value">6</td>
                <td class="metric-value">98</td>
                <td class="metric-value">$38,900</td>
                <td>
                    <button class="btn btn-sm btn-secondary">View</button>
                    <button class="btn btn-sm btn-secondary">Edit</button>
                </td>
            </tr>
        </tbody>
    </table>
</div>

<div class="tab-content" id="tab2">
    <div class="section-header">
        <div class="section-label admin-section-label">
          <span class="section-label-line"></span>
          <span class="section-label-text">Performance Leaderboard</span>
          <span class="section-label-line"></span>
        </div>
        <select class="filter-select">
            <option>This Month</option>
            <option>Last Month</option>
            <option>This Quarter</option>
            <option>This Year</option>
        </select>
    </div>

    <div class="charts-grid charts-grid-2">
        <div class="chart-card">
            <div class="chart-card-header">
                <h3 class="chart-card-title">Deals Closed by Agent</h3>
            </div>
            <div class="chart-card-body">
                <canvas id="dealsChart"></canvas>
            </div>
        </div>

        <div class="chart-card">
            <div class="chart-card-header">
                <h3 class="chart-card-title">Revenue by Agent</h3>
            </div>
            <div class="chart-card-body">
                <canvas id="revenueChart"></canvas>
            </div>
        </div>
    </div>
</div>

<div class="tab-content" id="tab3">
    <div class="section-label admin-section-label">
      <span class="section-label-line"></span>
      <span class="section-label-text">Lead Assignments</span>
      <span class="section-label-line"></span>
    </div>
    <p class="text-gray-500 mb-6">Manage lead assignments across your team</p>
    <a href="/admin/lead-assignment" class="btn btn-primary">Manage Assignments</a>
</div>

<div class="tab-content" id="tab4">
    <div class="section-label admin-section-label">
      <span class="section-label-line"></span>
      <span class="section-label-text">Commission Tracking</span>
      <span class="section-label-line"></span>
    </div>
    <p class="text-gray-500 mb-6">Track and manage team commissions</p>
    <a href="/admin/commissions" class="btn btn-primary">View Commissions</a>
</div>
{{end}}

{{define "scripts"}}
<script>
    document.querySelectorAll('.tab-button').forEach(button => {
        button.addEventListener('click', function() {
            document.querySelectorAll('.tab-button').forEach(b => b.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
            
            this.classList.add('active');
            document.getElementById(this.dataset.tab).classList.add('active');
        });
    });

    const dealsCtx = document.getElementById('dealsChart');
    if (dealsCtx) {
        new Chart(dealsCtx, {
            type: 'bar',
            data: {
                labels: ['Mike Johnson', 'Amy Smith', 'John Davis'],
                datasets: [{
                    label: 'Deals Closed',
                    data: [18, 15, 14],
                    backgroundColor: 'rgba(27, 53, 89, 0.8)'
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false
            }
        });
    }

    const revenueCtx = document.getElementById('revenueChart');
    if (revenueCtx) {
        new Chart(revenueCtx, {
            type: 'line',
            data: {
                labels: ['Mike Johnson', 'Amy Smith', 'John Davis'],
                datasets: [{
                    label: 'Revenue',
                    data: [52300, 38900, 31200],
                    borderColor: 'rgb(196, 169, 98)',
                    backgroundColor: 'rgba(196, 169, 98, 0.1)',
                    tension: 0.4
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false
            }
        });
    }
</script>
{{end}}
