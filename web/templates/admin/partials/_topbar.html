<header class="admin-header">
    <div class="admin-header-content">
        <h1 class="admin-header-title">{{.PageTitle}}</h1>
        
        <div class="admin-header-actions">
            {{if .ShowVisitorCounter}}
            <div class="visitor-counter" 
                 x-data="visitorCounter()"
                 x-init="init()"
                 :class="{ 'high-traffic': count >= 6, 'no-visitors': count === 0 }">
                <div class="counter-main" @mouseenter="showBreakdown = true" @mouseleave="showBreakdown = false">
                    <span class="counter-icon">üëÅÔ∏è</span>
                    <span class="counter-value" 
                          x-text="count"
                          :class="{ 'pulse': justChanged }"></span>
                    <span class="counter-label">
                        <span x-text="count === 1 ? 'visitor' : 'visitors'"></span> browsing now
                    </span>
                    <div class="counter-trend" x-show="trend !== 0">
                        <span x-text="trend > 0 ? '‚ñ≤' : '‚ñº'" :class="trend > 0 ? 'trend-up' : 'trend-down'"></span>
                        <span x-text="Math.abs(trend)"></span>
                    </div>
                </div>
                <div class="counter-breakdown" x-show="showBreakdown && Object.keys(byPage).length > 0" x-transition>
                    <template x-for="(pageCount, page) in byPage" :key="page">
                        <div class="breakdown-item">
                            <span class="breakdown-count" x-text="pageCount"></span> on <span class="breakdown-page" x-text="page"></span>
                        </div>
                    </template>
                    <div class="breakdown-meta" x-show="hotCount > 0">
                        <span class="hot-badge">üî• <span x-text="hotCount"></span> hot leads</span>
                    </div>
                </div>
            </div>
            {{end}}
            
            <div class="admin-search">
                <input type="search" placeholder="Search..." x-model="searchQuery" @input.debounce.300ms="performSearch">
                <svg class="admin-search-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                </svg>
            </div>
            
            <div class="notification-bell" 
                 x-data="{ open: false, unreadCount: 0, notifications: [] }"
                 x-init="window.notificationBell = $el; if (window.adminNotifications) { unreadCount = window.adminNotifications.unreadCount; notifications = window.adminNotifications.notifications.slice(0, 5); }"
                 @click.outside="open = false">
                <button class="bell-button" @click="open = !open" :class="{ 'has-unread': unreadCount > 0 }">
                    <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"></path>
                    </svg>
                    <span class="notification-badge" x-show="unreadCount > 0" x-text="unreadCount > 99 ? '99+' : unreadCount"></span>
                </button>
                
                <div class="notification-dropdown" x-show="open" x-transition>
                    <div class="notification-header">
                        <h4>Notifications</h4>
                        <button class="mark-all-read" @click="window.adminNotifications?.markAllAsRead()" x-show="unreadCount > 0">
                            Mark all read
                        </button>
                    </div>
                    
                    <div class="notification-list">
                        <template x-if="notifications.length === 0">
                            <div class="no-notifications">
                                <svg width="48" height="48" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M20 13.5v-8A2.5 2.5 0 0017.5 3h-11A2.5 2.5 0 004 5.5v13A2.5 2.5 0 006.5 21h6.5"></path>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M18 21l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2"></path>
                                </svg>
                                <p>No notifications</p>
                            </div>
                        </template>
                        
                        <template x-for="notification in notifications" :key="notification.id">
                            <div class="notification-item" 
                                 :class="{ 'unread': !notification.read, ['priority-' + notification.priority]: true }"
                                 @click="window.adminNotifications?.markAsRead(notification.id)">
                                <div class="notification-icon" :class="'type-' + notification.type"></div>
                                <div class="notification-content">
                                    <div class="notification-title" x-text="notification.title"></div>
                                    <div class="notification-message" x-text="notification.message"></div>
                                    <div class="notification-time" x-text="window.adminNotifications?.formatTimeAgo(notification.created_at)"></div>
                                </div>
                            </div>
                        </template>
                    </div>
                    
                    <div class="notification-footer">
                        <a href="/admin/notifications" class="view-all">View all notifications</a>
                    </div>
                </div>
            </div>
            
            <div class="admin-user-menu">
                <div class="admin-user-avatar" x-text="userProfile.initials"></div>
                <div class="admin-user-info">
                    <div class="admin-user-name" x-text="userProfile.username"></div>
                    <div class="admin-user-role" x-text="userProfile.role"></div>
                </div>
            </div>
            
            <a href="/admin/logout" class="btn-logout">
                <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"></path>
                </svg>
                Logout
            </a>
        </div>
    </div>
</header>
